<!DOCTYPE html>
<html>
  <head><!--HTML tag-->
    <title> Movie production - keywords </title> <!--HTML element (with complete tags)-->
  </head>
  <body>
    <h1> Choose the quarter you want to publish your movie! </h1>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src = "./quarters_world.js"></script>
    <script src = "./quarters_usa.js"></script>
    <script src = "./dvcore6.js"></script>
    
    <div id="my_dataviz"></div>
    <script> 
      function calc_lg(value){
          return (Math.log(Math.abs(value))/Math.log(10))*Math.sign(value);
      }
      function data_proc(dataset){
        const data_raw = dataset;
        const data = [];
        // console.log('log in jscode, data_raw', data_raw);
        data_raw.forEach(elem => {
            data.push({
                year: elem[0], 
                net_prof: calc_lg(elem[2]), 
                quarter: elem[1]
            });
        });
        return data;
      }
    </script>
    <script type="module">
      quarter_world = data_proc(quarter_world);

      console.log('quarter_world', quarter_world[0]);
      chart = StackedBarChart(quarter_world, {
        x: d => d.net_prof,
        y: d => d.year,
        z: d => d.quarter,
        xLabel: "← lose more · Net Profit · earn more →",
        yDomain: d3.extent(quarter_world, d => d.value),
        zDomain: quarter_world.quarter,
        colors: d3.schemeSpectral[4],
        marginLeft: 70
      })
    </script>
  </body>
</html>
